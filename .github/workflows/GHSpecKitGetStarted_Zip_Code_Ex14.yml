name: CreateGHSpecKitEx14Zip
on:
  workflow_dispatch:
  push:
    branches:
      - '**'
    paths:
      - DownloadableCodeProjects/standalone-lab-projects/sdd-get-started-rss-feed/**/*.md
  pull_request:
    branches:
      - '**'
    paths:
      - DownloadableCodeProjects/standalone-lab-projects/sdd-get-started-rss-feed/**/*.md

defaults:
  run:
    shell: bash

jobs:
  create_zip:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    - name: Create GHSpecKitEx14 Stakeholder Documents zip
      run: | 
        # Ensure Downloads directory exists
        mkdir -p DownloadableCodeProjects/Downloads

        # Remove existing zip file
        rm -f DownloadableCodeProjects/Downloads/GHSpecKitEx14StakeholderDocuments.zip

        # Create zip containing the entire folder (including StakeholderDocuments)
        zip -r -q DownloadableCodeProjects/Downloads/GHSpecKitEx14StakeholderDocuments.zip \
          DownloadableCodeProjects/standalone-lab-projects/sdd-get-started-rss-feed

        # Verify zip file was created
        if [ ! -f DownloadableCodeProjects/Downloads/GHSpecKitEx14StakeholderDocuments.zip ]; then
          echo "Failed to create zip file"
          exit 1
        fi

        echo "Successfully created GHSpecKitEx14StakeholderDocuments.zip"
    - name: Commit and push
      uses: Endbug/add-and-commit@v7
      with:
        add: '["DownloadableCodeProjects/Downloads/GHSpecKitEx14StakeholderDocuments.zip"]'
        message: 'Updating Zip with sample app source files'
        push: true
